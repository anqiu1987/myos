#include "./../include/stdlib.h"#include "./../include/sheet.h"#define SHEET_USED 1struct SHTCTL*shtctl_init(unsigned char * vram, int xsize, int ysize){	struct SHTCTL* ctl;	int i;	ctl = (struct SHTCTL*)malloc(sizeof(struct SHTCTL));//因为这个结构很大所以我们最好通过动态分配内存，以防止栈溢出	if(ctl == 0)	{		return ctl;	}		ctl->map = (struct SHTCTL*)malloc(MAP_PAGE_SIZE);				ctl->vram = vram;	ctl->xsize = xsize;	ctl->ysize = ysize;	ctl->top = -1;	for(i = 0; i < MAX_SHEETS; i++)	{		ctl->sheet0[i].flags = 0;//标记未使用	}}//查找空闲的图层struct SHEET* sheet_alloc(struct SHTCTL* ctl){		int i;	for(i = 0; i < MAX_SHEETS; i++)	{		if(ctl->sheet0[i].flags == 0)		{			ctl->sheet0[i].flags = SHEET_USED;			ctl->sheet0[i].height = -1;			return &(ctl->sheet0[i]);		}	}	return (struct SHEET*)0;}void sheet_setbuf(struct SHEET*sht, unsigned char * buf, int xsize, int ysize, int col_inv){	sht->buf = buf;	sht->bxsize = xsize;	sht->bysize = ysize; 	sht->col_inv = col_inv;}//释放该页面void sheet_free(struct SHEET *sht){	sht->flags = 0;}